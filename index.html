<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Practice Player</title>

<style>
body{
    font-family:sans-serif;
    text-align:center;
    padding:20px;
    background:#f5f6fa;
}
.card{
    background:white;
    padding:20px;
    border-radius:12px;
    box-shadow:0 5px 20px rgba(0,0,0,0.1);
}
input[type=range]{width:100%;}
button{
    padding:10px 16px;
    margin:6px;
    font-size:15px;
}
.big{font-size:18px;font-weight:bold;}
</style>
</head>

<body>

<div class="card">

<h2>ğŸ¸ ç·´ç¿’ç”¨ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼</h2>

<input type="file" id="fileInput"><br><br>
<audio id="audio" controls></audio>

<h3>å†ç”Ÿé€Ÿåº¦</h3>
<input type="range" id="speed" min="0.5" max="1.5" step="0.01" value="1">
<p class="big" id="speedValue">1.00x</p>

<h3>A-Bãƒ«ãƒ¼ãƒ—</h3>
<button onclick="setA()">Aè¨­å®š</button>
<button onclick="setB()">Bè¨­å®š</button>
<button onclick="clearLoop()">è§£é™¤</button>
<p id="loopStatus">æœªè¨­å®š</p>

<h3>10ç§’æˆ»ã‚‹ / é€²ã‚€</h3>
<button onclick="skip(-10)">â—€ 10ç§’</button>
<button onclick="skip(10)">10ç§’ â–¶</button>

</div>

<script>
const audio=document.getElementById('audio');
const fileInput=document.getElementById('fileInput');
const speed=document.getElementById('speed');
const speedValue=document.getElementById('speedValue');
const loopStatus=document.getElementById('loopStatus');

let A=null;
let B=null;

fileInput.addEventListener('change',()=>{
    audio.src=URL.createObjectURL(fileInput.files[0]);
});

speed.addEventListener('input',()=>{
    audio.playbackRate=speed.value;
    audio.preservesPitch=true;
    audio.webkitPreservesPitch=true;
    speedValue.innerText=parseFloat(speed.value).toFixed(2)+"x";
});

function setA(){
    A=audio.currentTime;
    loopStatus.innerText="A:"+A.toFixed(1);
}
function setB(){
    B=audio.currentTime;
    loopStatus.innerText="A:"+A.toFixed(1)+" / B:"+B.toFixed(1);
}
function clearLoop(){
    A=null; B=null;
    loopStatus.innerText="è§£é™¤";
}
function skip(sec){
    audio.currentTime+=sec;
}

audio.addEventListener("timeupdate",()=>{
    if(A!==null && B!==null){
        if(audio.currentTime>=B){
            audio.currentTime=A;
        }
    }
});
</script>

</body>
</html>
